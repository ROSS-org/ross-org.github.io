<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ROSS: core/tw-stats.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ROSS
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">core/tw-stats.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tw-stats_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &lt;<a class="code" href="ross_8h.html">ross.h</a>&gt;</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef ROSS_DO_NOT_PRINT</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00005"></a><a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">00005</a> <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="ross-types_8h.html#a68910a3e880a16d5acbac8fc120229a2">tw_stat</a> v)
<a name="l00006"></a>00006 {
<a name="l00007"></a>00007         printf(<span class="stringliteral">&quot;\t%-50s %11lld\n&quot;</span>, name, v);
<a name="l00008"></a>00008         fprintf(<a class="code" href="ross-extern_8h.html#a8747c3bfc331d131dd546883b336feef">g_tw_csv</a>, <span class="stringliteral">&quot;%lld,&quot;</span>, v);
<a name="l00009"></a>00009 }
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00012"></a><a class="code" href="tw-stats_8c.html#a833fd4a6c61467eb69ced0082061703f">00012</a> <a class="code" href="tw-stats_8c.html#a833fd4a6c61467eb69ced0082061703f">show_2f</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> v)
<a name="l00013"></a>00013 {
<a name="l00014"></a>00014         printf(<span class="stringliteral">&quot;\t%-50s %11.2f %%\n&quot;</span>, name, v);
<a name="l00015"></a>00015         fprintf(<a class="code" href="ross-extern_8h.html#a8747c3bfc331d131dd546883b336feef">g_tw_csv</a>, <span class="stringliteral">&quot;%.2f,&quot;</span>, v);
<a name="l00016"></a>00016 }
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00019"></a><a class="code" href="tw-stats_8c.html#a6b69bed4fb0f6988ac343b34447c6b07">00019</a> <a class="code" href="tw-stats_8c.html#a6b69bed4fb0f6988ac343b34447c6b07">show_1f</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> v)
<a name="l00020"></a>00020 {
<a name="l00021"></a>00021         printf(<span class="stringliteral">&quot;\t%-50s %11.1f\n&quot;</span>, name, v);
<a name="l00022"></a>00022         fprintf(<a class="code" href="ross-extern_8h.html#a8747c3bfc331d131dd546883b336feef">g_tw_csv</a>, <span class="stringliteral">&quot;%.2f,&quot;</span>, v);
<a name="l00023"></a>00023 }
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00026"></a><a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">00026</a> <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> v)
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028         printf(<span class="stringliteral">&quot;\t%-50s %11.4lf\n&quot;</span>, name, v);
<a name="l00029"></a>00029         fprintf(<a class="code" href="ross-extern_8h.html#a8747c3bfc331d131dd546883b336feef">g_tw_csv</a>, <span class="stringliteral">&quot;%.4lf,&quot;</span>, v);
<a name="l00030"></a>00030 }
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="keywordtype">void</span>
<a name="l00035"></a><a class="code" href="tw-stats_8c.html#a0782b6be50ca83cb7f43782cde7d9ad4">00035</a> <a class="code" href="ross-extern_8h.html#a0782b6be50ca83cb7f43782cde7d9ad4">tw_stats</a>(<a class="code" href="structtw__pe.html" title="Holds the entire PE state.">tw_pe</a> * me)
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037         <a class="code" href="structtw__statistics.html" title="Statistics tallied over the duration of the simulation.">tw_statistics</a> s;
<a name="l00038"></a>00038 
<a name="l00039"></a>00039         <a class="code" href="structtw__pe.html" title="Holds the entire PE state.">tw_pe</a>   *<a class="code" href="avl__tree_8c.html#ac4c639748d4d5a271d6c54a18f614605">pe</a>;
<a name="l00040"></a>00040         <a class="code" href="structtw__kp.html">tw_kp</a>   *kp;
<a name="l00041"></a>00041         <a class="code" href="structtw__lp.html" title="LP State Structure.">tw_lp</a>   *lp = NULL;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043         <span class="keywordtype">int</span>      i;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045         <span class="keywordtype">size_t</span> m_alloc, m_waste;
<a name="l00046"></a>00046 
<a name="l00047"></a>00047         <span class="keywordflow">if</span> (me != <a class="code" href="ross-extern_8h.html#ae4fff7ff5b07598710d293ac564611f6">g_tw_pe</a>[0])
<a name="l00048"></a>00048                 <span class="keywordflow">return</span>;
<a name="l00049"></a>00049 
<a name="l00050"></a>00050         <span class="keywordflow">if</span> (0 == <a class="code" href="ross-extern_8h.html#ad8dd0c6c6e24d52a9fc457a6d85bd561">g_tw_sim_started</a>)
<a name="l00051"></a>00051                 <span class="keywordflow">return</span>;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053         <a class="code" href="ross-extern_8h.html#aad9cd95e0d933f14b3c1a4b7c81e0f97">tw_calloc_stats</a>(&amp;m_alloc, &amp;m_waste);
<a name="l00054"></a>00054         bzero(&amp;s, <span class="keyword">sizeof</span>(s));
<a name="l00055"></a>00055 
<a name="l00056"></a>00056         <span class="keywordflow">for</span>(pe = NULL; (pe = <a class="code" href="ross-extern_8h.html#a0e0e97fb2a9b6837cd912af7c69a2393">tw_pe_next</a>(pe));)
<a name="l00057"></a>00057         {
<a name="l00058"></a>00058                 <a class="code" href="tw-timing_8h.html#afb3cc3360b4871f1d990048a71b909c6">tw_wtime</a> rt;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060                 <a class="code" href="ross-extern_8h.html#a47c205fb13e816aa4a0252ab2e7cd094">tw_wall_sub</a>(&amp;rt, &amp;pe-&gt;<a class="code" href="structtw__pe.html#a164ff8a0fc75eddb81fb6629396fea39" title="When this PE finished its execution.">end_time</a>, &amp;pe-&gt;<a class="code" href="structtw__pe.html#ae9ea107324c86529f69a2b32526e19a8" title="When this PE first started execution.">start_time</a>);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062                 s.<a class="code" href="structtw__statistics.html#ab722d6c0f1d5a616b0b21789cbdecc16">s_max_run_time</a> = <a class="code" href="ross-kernel-inline_8h.html#afd7e8bb46e590a19612ac045cf3f6f03">ROSS_MAX</a>(s.<a class="code" href="structtw__statistics.html#ab722d6c0f1d5a616b0b21789cbdecc16">s_max_run_time</a>, <a class="code" href="ross-extern_8h.html#ae0f8e95d53bcbe6803081588d3058146">tw_wall_to_double</a>(&amp;rt));
<a name="l00063"></a>00063                 s.<a class="code" href="structtw__statistics.html#a80ffd79aaf7873cac6407f2fe36d72e9">s_nevent_abort</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a80ffd79aaf7873cac6407f2fe36d72e9">s_nevent_abort</a>;
<a name="l00064"></a>00064                 s.<a class="code" href="structtw__statistics.html#a6b0357b84363b0747399aef2e913f5e5">s_pq_qsize</a> += <a class="code" href="splay_8c.html#addf3f3d612922ac6c07304ddb4895ab7">tw_pq_get_size</a>(me-&gt;<a class="code" href="structtw__pe.html#a90e1dbe51a084d6e02580667159e13ff" title="Priority queue used to sort events.">pq</a>);
<a name="l00065"></a>00065 
<a name="l00066"></a>00066                 s.<a class="code" href="structtw__statistics.html#ab8856e6a9484744cb864ec3b94c1f86d">s_nsend_net_remote</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#ab8856e6a9484744cb864ec3b94c1f86d">s_nsend_net_remote</a>;
<a name="l00067"></a>00067                 s.<a class="code" href="structtw__statistics.html#a25c1b19b67e5b437265c98a444d89fc2">s_nsend_loc_remote</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a25c1b19b67e5b437265c98a444d89fc2">s_nsend_loc_remote</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069                 s.<a class="code" href="structtw__statistics.html#a950bfd3cce9aeb0874095350d634e977">s_nsend_network</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a950bfd3cce9aeb0874095350d634e977">s_nsend_network</a>;
<a name="l00070"></a>00070                 s.<a class="code" href="structtw__statistics.html#a67369ce1343843fe5d0bb6f723ccb140">s_nread_network</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a67369ce1343843fe5d0bb6f723ccb140">s_nread_network</a>;
<a name="l00071"></a>00071                 s.<a class="code" href="structtw__statistics.html#a1c50bb28d5a9481058f1b495210cb0a0">s_nsend_remote_rb</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a1c50bb28d5a9481058f1b495210cb0a0">s_nsend_remote_rb</a>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073                 s.<a class="code" href="structtw__statistics.html#a77e96c47b9469e7a2dac21158f66d192">s_total</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a77e96c47b9469e7a2dac21158f66d192">s_total</a>;
<a name="l00074"></a>00074                 s.<a class="code" href="structtw__statistics.html#a1c60ba2fc1683cc9cff5da33497f13f0">s_net_read</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a1c60ba2fc1683cc9cff5da33497f13f0">s_net_read</a>;
<a name="l00075"></a>00075                 s.<a class="code" href="structtw__statistics.html#a1fe13f0669aa85a80819965c67771b1c">s_gvt</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a1fe13f0669aa85a80819965c67771b1c">s_gvt</a>;
<a name="l00076"></a>00076                 s.<a class="code" href="structtw__statistics.html#a395ff98d71b2e8aaddcf293fa135cd7b">s_fossil_collect</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a395ff98d71b2e8aaddcf293fa135cd7b">s_fossil_collect</a>;
<a name="l00077"></a>00077                 s.<a class="code" href="structtw__statistics.html#abee413204afa47b508421b50b55cbbc4">s_event_abort</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#abee413204afa47b508421b50b55cbbc4">s_event_abort</a>;
<a name="l00078"></a>00078                 s.<a class="code" href="structtw__statistics.html#afb4f29bb6fd2359929db62d67b3f0c24">s_event_process</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#afb4f29bb6fd2359929db62d67b3f0c24">s_event_process</a>;
<a name="l00079"></a>00079                 s.<a class="code" href="structtw__statistics.html#a63bdf31079607ac79020b3efb874dedd">s_pq</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a63bdf31079607ac79020b3efb874dedd">s_pq</a>;
<a name="l00080"></a>00080                 s.<a class="code" href="structtw__statistics.html#a94f3a9b746bc08e1bd11a971256bd98a">s_rollback</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a94f3a9b746bc08e1bd11a971256bd98a">s_rollback</a>;
<a name="l00081"></a>00081                 s.<a class="code" href="structtw__statistics.html#a288053705e5e498d021498a1fe6a39e7">s_cancel_q</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a288053705e5e498d021498a1fe6a39e7">s_cancel_q</a>;
<a name="l00082"></a>00082         s.<a class="code" href="structtw__statistics.html#a62e777ce390693fbe7b4fb88110c3c10">s_pe_event_ties</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a62e777ce390693fbe7b4fb88110c3c10">s_pe_event_ties</a>;
<a name="l00083"></a>00083         s.<a class="code" href="structtw__statistics.html#ae95e17e6072554ba17501ee43134f912">s_min_detected_offset</a> = <a class="code" href="ross-extern_8h.html#a9686e9a8f81fed83fe0699dd0dc2fe82">g_tw_min_detected_offset</a>;
<a name="l00084"></a>00084         s.<a class="code" href="structtw__statistics.html#a57f9136844021515905c3a6bc70eb921">s_avl</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a57f9136844021515905c3a6bc70eb921">s_avl</a>;
<a name="l00085"></a>00085         s.<a class="code" href="structtw__statistics.html#a11793b1e0f358ce83e0f0e7d858f14c5">s_buddy</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a11793b1e0f358ce83e0f0e7d858f14c5">s_buddy</a>;
<a name="l00086"></a>00086         s.<a class="code" href="structtw__statistics.html#a43c6da6365aebc030d939dc378daf154">s_lz4</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#a43c6da6365aebc030d939dc378daf154">s_lz4</a>;
<a name="l00087"></a>00087         s.<a class="code" href="structtw__statistics.html#abd593404137ee16d70a5c87547ad52d8">s_events_past_end</a> += pe-&gt;<a class="code" href="structtw__pe.html#ac1d26b7bfd058cc55cbf5ee201edb83c" title="per PE counters">stats</a>.<a class="code" href="structtw__statistics.html#abd593404137ee16d70a5c87547ad52d8">s_events_past_end</a>;
<a name="l00088"></a>00088 
<a name="l00089"></a>00089                 <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="ross-extern_8h.html#a4a237c68db5a0325e986d3710088d427">g_tw_nkp</a>; i++)
<a name="l00090"></a>00090                 {
<a name="l00091"></a>00091                         kp = <a class="code" href="ross-kernel-inline_8h.html#a4066dfaca8faa4af256a377d85cea32f">tw_getkp</a>(i);
<a name="l00092"></a>00092                         s.<a class="code" href="structtw__statistics.html#a81aae87c2c31239b501b7461e93effa2">s_nevent_processed</a> += kp-&gt;<a class="code" href="structtw__kp.html#ac6d205df22a30a62f5694ac1d3d1c14a" title="Number of events processed.">s_nevent_processed</a>;
<a name="l00093"></a>00093                         s.<a class="code" href="structtw__statistics.html#a97f53f996639cd3ddd6c975addd0e984">s_e_rbs</a> += kp-&gt;<a class="code" href="structtw__kp.html#a2c69e0142ab6df7345feeb819dc7b86a" title="Number of events rolled back by this LP.">s_e_rbs</a>;
<a name="l00094"></a>00094                         s.<a class="code" href="structtw__statistics.html#ae1f695b710d56b9deb71d8c32f5ea433">s_rb_total</a> += kp-&gt;<a class="code" href="structtw__kp.html#ae0128e497a3731c114d91552ae531ce8" title="Number of total rollbacks by this LP.">s_rb_total</a>;
<a name="l00095"></a>00095                         s.<a class="code" href="structtw__statistics.html#ab569d8a20ab672eeb8ba0198154dd5ff">s_rb_secondary</a> += kp-&gt;<a class="code" href="structtw__kp.html#abe641c39eb731b4d96fa1ef0f3ecc95d" title="Number of secondary rollbacks by this LP.">s_rb_secondary</a>;
<a name="l00096"></a>00096                 }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098                 <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="ross-extern_8h.html#ab8bd876929690758e922961bcc16cd64">g_tw_nlp</a>; i++)
<a name="l00099"></a>00099                 {
<a name="l00100"></a>00100                         lp = <a class="code" href="ross-kernel-inline_8h.html#a01d028965db8257815ad2ed053a0e40a">tw_getlp</a>(i);
<a name="l00101"></a>00101                         <span class="keywordflow">if</span> (lp-&gt;<a class="code" href="structtw__lp.html#a205f09ff294b6bb1f61eab7b099ebea2" title="Type of this LP, including service callbacks.">type</a>-&gt;<a class="code" href="structtw__lptype.html#a856cedae864c930e88106a4164a84ae4" title="Final handler routine.">final</a>)
<a name="l00102"></a>00102                                 (*lp-&gt;<a class="code" href="structtw__lp.html#a205f09ff294b6bb1f61eab7b099ebea2" title="Type of this LP, including service callbacks.">type</a>-&gt;<a class="code" href="structtw__lptype.html#a856cedae864c930e88106a4164a84ae4" title="Final handler routine.">final</a>) (lp-&gt;<a class="code" href="structtw__lp.html#a34fb8e673f23705156b2473503e8a2d5" title="Current application LP data.">cur_state</a>, lp);
<a name="l00103"></a>00103                 }
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106         s.<a class="code" href="structtw__statistics.html#afbaa299bc177b669536d9fd2986d628f">s_fc_attempts</a> = <a class="code" href="ross-extern_8h.html#af545d515aac1a8f3f15aa261af6db1e2">g_tw_fossil_attempts</a>;
<a name="l00107"></a>00107         s.<a class="code" href="structtw__statistics.html#a828101c0647ffa8c15ac324dba6b09d4">s_net_events</a> = s.<a class="code" href="structtw__statistics.html#a81aae87c2c31239b501b7461e93effa2">s_nevent_processed</a> - s.<a class="code" href="structtw__statistics.html#a97f53f996639cd3ddd6c975addd0e984">s_e_rbs</a>;
<a name="l00108"></a>00108         s.<a class="code" href="structtw__statistics.html#ab248db5d9a1cd9b1f727be0569ea16db">s_rb_primary</a> = s.<a class="code" href="structtw__statistics.html#ae1f695b710d56b9deb71d8c32f5ea433">s_rb_total</a> - s.<a class="code" href="structtw__statistics.html#ab569d8a20ab672eeb8ba0198154dd5ff">s_rb_secondary</a>;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110         s = *(<a class="code" href="network-mpi_8c.html#abbcd0d5ea79ad57229162f703309142d" title="Function to output the statistics.">tw_net_statistics</a>(me, &amp;s));
<a name="l00111"></a>00111 
<a name="l00112"></a>00112         <span class="keywordflow">if</span> (!<a class="code" href="ross-kernel-inline_8h.html#a0e8a2538926cdb59af049a899566de6c">tw_ismaster</a>())
<a name="l00113"></a>00113                 <span class="keywordflow">return</span>;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="preprocessor">#ifndef ROSS_DO_NOT_PRINT</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\n\t: Running Time = %.4f seconds\n&quot;</span>, s.<a class="code" href="structtw__statistics.html#ab722d6c0f1d5a616b0b21789cbdecc16">s_max_run_time</a>);
<a name="l00117"></a>00117         fprintf(<a class="code" href="ross-extern_8h.html#a8747c3bfc331d131dd546883b336feef">g_tw_csv</a>, <span class="stringliteral">&quot;%.4f,&quot;</span>, s.<a class="code" href="structtw__statistics.html#ab722d6c0f1d5a616b0b21789cbdecc16">s_max_run_time</a>);
<a name="l00118"></a>00118 
<a name="l00119"></a>00119         printf(<span class="stringliteral">&quot;\nTW Library Statistics:\n&quot;</span>);
<a name="l00120"></a>00120         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Total Events Processed&quot;</span>, s.<a class="code" href="structtw__statistics.html#a81aae87c2c31239b501b7461e93effa2">s_nevent_processed</a>);
<a name="l00121"></a>00121         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Events Aborted (part of RBs)&quot;</span>, s.<a class="code" href="structtw__statistics.html#a80ffd79aaf7873cac6407f2fe36d72e9">s_nevent_abort</a>);
<a name="l00122"></a>00122         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Events Rolled Back&quot;</span>, s.<a class="code" href="structtw__statistics.html#a97f53f996639cd3ddd6c975addd0e984">s_e_rbs</a>);
<a name="l00123"></a>00123         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Event Ties Detected in PE Queues&quot;</span>, s.<a class="code" href="structtw__statistics.html#a62e777ce390693fbe7b4fb88110c3c10">s_pe_event_ties</a>);
<a name="l00124"></a>00124         <span class="keywordflow">if</span>(<a class="code" href="ross-extern_8h.html#ae22db4d4e754eff64535402f5fa60a5f">g_tw_synchronization_protocol</a> == <a class="code" href="ross-types_8h.html#abea764c61c75c56008ccf665a71246fda70cd78c3dbc0801ed52437fa82a6e8ef">CONSERVATIVE</a>)
<a name="l00125"></a>00125             printf(<span class="stringliteral">&quot;\t%-50s %11.9lf\n&quot;</span>,
<a name="l00126"></a>00126                <span class="stringliteral">&quot;Minimum TS Offset Detected in Conservative Mode&quot;</span>,  
<a name="l00127"></a>00127                (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#ae95e17e6072554ba17501ee43134f912">s_min_detected_offset</a>);
<a name="l00128"></a>00128         <a class="code" href="tw-stats_8c.html#a833fd4a6c61467eb69ced0082061703f">show_2f</a>(<span class="stringliteral">&quot;Efficiency&quot;</span>, 100.0 * (1.0 - ((<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a97f53f996639cd3ddd6c975addd0e984">s_e_rbs</a> / (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a828101c0647ffa8c15ac324dba6b09d4">s_net_events</a>)));
<a name="l00129"></a>00129         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Total Remote (shared mem) Events Processed&quot;</span>, s.<a class="code" href="structtw__statistics.html#a25c1b19b67e5b437265c98a444d89fc2">s_nsend_loc_remote</a>);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131         <a class="code" href="tw-stats_8c.html#a833fd4a6c61467eb69ced0082061703f">show_2f</a>(
<a name="l00132"></a>00132                 <span class="stringliteral">&quot;Percent Remote Events&quot;</span>,
<a name="l00133"></a>00133                 ( (<span class="keywordtype">double</span>)s.<a class="code" href="structtw__statistics.html#a25c1b19b67e5b437265c98a444d89fc2">s_nsend_loc_remote</a>
<a name="l00134"></a>00134                 / (<span class="keywordtype">double</span>)s.<a class="code" href="structtw__statistics.html#a828101c0647ffa8c15ac324dba6b09d4">s_net_events</a>)
<a name="l00135"></a>00135                 * 100.0
<a name="l00136"></a>00136         );
<a name="l00137"></a>00137 
<a name="l00138"></a>00138         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Total Remote (network) Events Processed&quot;</span>, s.<a class="code" href="structtw__statistics.html#ab8856e6a9484744cb864ec3b94c1f86d">s_nsend_net_remote</a>);
<a name="l00139"></a>00139         <a class="code" href="tw-stats_8c.html#a833fd4a6c61467eb69ced0082061703f">show_2f</a>(
<a name="l00140"></a>00140                 <span class="stringliteral">&quot;Percent Remote Events&quot;</span>,
<a name="l00141"></a>00141                 ( (<span class="keywordtype">double</span>)s.<a class="code" href="structtw__statistics.html#ab8856e6a9484744cb864ec3b94c1f86d">s_nsend_net_remote</a>
<a name="l00142"></a>00142                 / (<span class="keywordtype">double</span>)s.<a class="code" href="structtw__statistics.html#a828101c0647ffa8c15ac324dba6b09d4">s_net_events</a>)
<a name="l00143"></a>00143                 * 100.0
<a name="l00144"></a>00144         );
<a name="l00145"></a>00145 
<a name="l00146"></a>00146         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00147"></a>00147         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Total Roll Backs &quot;</span>, s.<a class="code" href="structtw__statistics.html#ae1f695b710d56b9deb71d8c32f5ea433">s_rb_total</a>);
<a name="l00148"></a>00148         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Primary Roll Backs &quot;</span>, s.<a class="code" href="structtw__statistics.html#ab248db5d9a1cd9b1f727be0569ea16db">s_rb_primary</a>);
<a name="l00149"></a>00149         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Secondary Roll Backs &quot;</span>, s.<a class="code" href="structtw__statistics.html#ab569d8a20ab672eeb8ba0198154dd5ff">s_rb_secondary</a>);
<a name="l00150"></a>00150         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Fossil Collect Attempts&quot;</span>, s.<a class="code" href="structtw__statistics.html#afbaa299bc177b669536d9fd2986d628f">s_fc_attempts</a>);
<a name="l00151"></a>00151         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Total GVT Computations&quot;</span>, <a class="code" href="ross-extern_8h.html#aad7609a89939a59a33ae1cd1f5601e7e">g_tw_gvt_done</a>);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00154"></a>00154         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Net Events Processed&quot;</span>, s.<a class="code" href="structtw__statistics.html#a828101c0647ffa8c15ac324dba6b09d4">s_net_events</a>);
<a name="l00155"></a>00155         <a class="code" href="tw-stats_8c.html#a6b69bed4fb0f6988ac343b34447c6b07">show_1f</a>(
<a name="l00156"></a>00156                 <span class="stringliteral">&quot;Event Rate (events/sec)&quot;</span>,
<a name="l00157"></a>00157                 ((<span class="keywordtype">double</span>)s.<a class="code" href="structtw__statistics.html#a828101c0647ffa8c15ac324dba6b09d4">s_net_events</a> / s.<a class="code" href="structtw__statistics.html#ab722d6c0f1d5a616b0b21789cbdecc16">s_max_run_time</a>)
<a name="l00158"></a>00158         );
<a name="l00159"></a>00159 
<a name="l00160"></a>00160         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Total Events Scheduled Past End Time&quot;</span>, s.<a class="code" href="structtw__statistics.html#abd593404137ee16d70a5c87547ad52d8">s_events_past_end</a>);
<a name="l00161"></a>00161         
<a name="l00162"></a>00162         printf(<span class="stringliteral">&quot;\nTW Memory Statistics:\n&quot;</span>);
<a name="l00163"></a>00163         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Events Allocated&quot;</span>, <a class="code" href="ross-extern_8h.html#a57043bf25127f521210bbf779e283e13">g_tw_events_per_pe</a> * <a class="code" href="ross-extern_8h.html#ab70670daa39e7d964eef4b745914cffa">g_tw_npe</a>);
<a name="l00164"></a>00164         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Memory Allocated&quot;</span>, m_alloc / 1024);
<a name="l00165"></a>00165         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Memory Wasted&quot;</span>, m_waste / 1024);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167         <span class="keywordflow">if</span> (<a class="code" href="network-mpi_8c.html#a2818efb70df48e5e29d3dacb3e2de009">tw_nnodes</a>() &gt; 1) {
<a name="l00168"></a>00168                 printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00169"></a>00169                 printf(<span class="stringliteral">&quot;TW Network Statistics:\n&quot;</span>);
<a name="l00170"></a>00170                 <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Remote sends&quot;</span>, s.<a class="code" href="structtw__statistics.html#a950bfd3cce9aeb0874095350d634e977">s_nsend_network</a>);
<a name="l00171"></a>00171                 <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Remote recvs&quot;</span>, s.<a class="code" href="structtw__statistics.html#a67369ce1343843fe5d0bb6f723ccb140">s_nread_network</a>);
<a name="l00172"></a>00172         }
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         printf(<span class="stringliteral">&quot;\nTW Data Structure sizes in bytes (sizeof):\n&quot;</span>);
<a name="l00175"></a>00175         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;PE struct&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="structtw__pe.html" title="Holds the entire PE state.">tw_pe</a>));
<a name="l00176"></a>00176         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;KP struct&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="structtw__kp.html">tw_kp</a>));
<a name="l00177"></a>00177         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;LP struct&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="structtw__lp.html" title="LP State Structure.">tw_lp</a>));
<a name="l00178"></a>00178         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;LP Model struct&quot;</span>, lp-&gt;<a class="code" href="structtw__lp.html#a205f09ff294b6bb1f61eab7b099ebea2" title="Type of this LP, including service callbacks.">type</a>-&gt;<a class="code" href="structtw__lptype.html#a1cf12b802abfdbb67ea25dd8c5921058" title="Number of bytes that SV is for the LP.">state_sz</a>);
<a name="l00179"></a>00179         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;LP RNGs&quot;</span>, <span class="keyword">sizeof</span>(*lp-&gt;<a class="code" href="structtw__lp.html#af7e48c8a55f5fff35746ac044df1902f" title="RNG stream array for this LP.">rng</a>));
<a name="l00180"></a>00180         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Total LP&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="structtw__lp.html" title="LP State Structure.">tw_lp</a>) + lp-&gt;<a class="code" href="structtw__lp.html#a205f09ff294b6bb1f61eab7b099ebea2" title="Type of this LP, including service callbacks.">type</a>-&gt;<a class="code" href="structtw__lptype.html#a1cf12b802abfdbb67ea25dd8c5921058" title="Number of bytes that SV is for the LP.">state_sz</a> + <span class="keyword">sizeof</span>(*lp-&gt;<a class="code" href="structtw__lp.html#af7e48c8a55f5fff35746ac044df1902f" title="RNG stream array for this LP.">rng</a>));
<a name="l00181"></a>00181         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Event struct&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="structtw__event.html" title="Event Stucture.">tw_event</a>));
<a name="l00182"></a>00182         <a class="code" href="tw-stats_8c.html#a8ee84a05b778d1e84ff6c36216fb7718">show_lld</a>(<span class="stringliteral">&quot;Event struct with Model&quot;</span>, <span class="keyword">sizeof</span>(<a class="code" href="structtw__event.html" title="Event Stucture.">tw_event</a>) + <a class="code" href="ross-extern_8h.html#a9d2ed177ca20252d6778f205eec20a83">g_tw_msg_sz</a>);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="preprocessor">#ifdef ROSS_timing</span>
<a name="l00185"></a>00185 <span class="preprocessor"></span>        printf(<span class="stringliteral">&quot;\nTW Clock Cycle Statistics (MAX values in secs at %1.4lf GHz):\n&quot;</span>, <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a> / 1000000000.0);
<a name="l00186"></a>00186         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Priority Queue (enq/deq)&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a63bdf31079607ac79020b3efb874dedd">s_pq</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00187"></a>00187     <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;AVL Tree (insert/delete)&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a57f9136844021515905c3a6bc70eb921">s_avl</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00188"></a>00188     <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;LZ4 (de)compression&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a43c6da6365aebc030d939dc378daf154">s_lz4</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00189"></a>00189     <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Buddy system&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a11793b1e0f358ce83e0f0e7d858f14c5">s_buddy</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00190"></a>00190         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Event Processing&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#afb4f29bb6fd2359929db62d67b3f0c24">s_event_process</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00191"></a>00191         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Event Cancel&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a288053705e5e498d021498a1fe6a39e7">s_cancel_q</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00192"></a>00192         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Event Abort&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#abee413204afa47b508421b50b55cbbc4">s_event_abort</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00193"></a>00193         printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00194"></a>00194         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;GVT&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a1fe13f0669aa85a80819965c67771b1c">s_gvt</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00195"></a>00195         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Fossil Collect&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a395ff98d71b2e8aaddcf293fa135cd7b">s_fossil_collect</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00196"></a>00196         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Primary Rollbacks&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a94f3a9b746bc08e1bd11a971256bd98a">s_rollback</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00197"></a>00197         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Network Read&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a1c60ba2fc1683cc9cff5da33497f13f0">s_net_read</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00198"></a>00198         <a class="code" href="tw-stats_8c.html#acf18fda42c51c1b9f24fc963c1ed0a15">show_4f</a>(<span class="stringliteral">&quot;Total Time (Note: Using Running Time above for Speedup)&quot;</span>, (<span class="keywordtype">double</span>) s.<a class="code" href="structtw__statistics.html#a77e96c47b9469e7a2dac21158f66d192">s_total</a> / <a class="code" href="ross-extern_8h.html#a2ec791ad8f66bd078868d9afe0ba3e72">g_tw_clock_rate</a>);
<a name="l00199"></a>00199 <span class="preprocessor">#endif</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>
<a name="l00201"></a>00201         <a class="code" href="mpi__allreduce_8c.html#a14d128d340e53baff763e91125748254">tw_gvt_stats</a>(stdout);
<a name="l00202"></a>00202 <span class="preprocessor">#endif</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span>}
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 2 2015 18:11:13 for ROSS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
